/*!
 *
 * GeoCanViz viewer / Visionneuse GÃ©oCanViz
 * gcviz.github.io/gcviz/License-eng.txt / gcviz.github.io/gcviz/Licence-fra.txt
 *
 * Version: v0.0.1-development Build: 2014-07-17- 11:44 AM
 *
 */
var locationPath;(function(){var b,a;define(["jquery-private","magnificpopup","jqueryui","gcviz-i18n","gcviz-func","gcviz-v-map","gcviz-v-inset","gcviz-v-header","gcviz-v-footer","gcviz-v-tbdraw","gcviz-v-tbnav","gcviz-v-tblegend","gcviz-v-tbdata"],function(r,p,s,i,u,t,n,q,m,f,k,g,o){var c,d,j,e,l,h;c=function(){var x=r(".gcviz"),w,v=x.length;r.extend(true,r,$);b=v;a=0;e();l();h();while(v--){w=x[v];d(w)}};d=function(w){var v=w.getAttribute("data-gcviz");r.support.cors=true;r.ajax({url:v,crossDomain:true,dataType:"json",async:false,success:function(x){x.gcviz.mapframe.id=w.getAttribute("id");j(w,x.gcviz);console.log(i.getDict("%msg-configread"))},error:function(){console.log(i.getDict("%msg-configerr")+": "+v)}})};j=function(C,y){var B,A=r(C),w=y.mapframe,x=w.id,z=w.size,v={};A.wrap("<section id=section"+x+' class="gcviz-section" role="map" style="width:'+z.width+"px; height:"+(z.height+80)+'px;">');B=r(document).find("#section"+x);r.extend(B,y);v.map=t.initialize(B);u.setVM(x,v);v.header=q.initialize(B);v.footer=m.initialize(B);if(y.toolbardraw.enable){v.draw=f.initialize(B)}if(y.toolbarnav.enable){v.nav=k.initialize(B)}if(y.toolbarlegend.enable){v.legend=g.initialize(B)}if(y.toolbardata.enable){v.data=o.initialize(B)}if(y.insetframe.enable){v.insets=n.initialize(B)}u.setVM(x,v);a+=1;if(a===b){r.event.trigger("gcviz-ready");window.onresize=u.debounce(function(){},500,false)}};e=function(){var y=document.getElementsByTagName("meta"),w=y.length;while(w--){if(y[w].getAttribute("property")==="location"){locationPath=y[w].getAttribute("content")}}if(typeof locationPath==="undefined"){var v=window.location.toString(),x=v.search("GeoCanViz");if(x!==-1){locationPath=v.substring(0,v.search("GeoCanViz"))+"GeoCanViz/"}}};l=function(){r.extend(true,$.magnificPopup.defaults,{tClose:i.getDict("%mp-close"),tLoading:i.getDict("%mp-load"),gallery:{tPrev:i.getDict("%mp-prev"),tNext:i.getDict("%mp-next"),tCounter:i.getDict("%mp-count")},image:{tError:i.getDict("%mp-error")}})};h=function(){r.fn.scrollTo=function(x,v,y){var w;if(typeof v==="function"&&arguments.length===2){y=v;v=x}w=$.extend({scrollTarget:x,offsetTop:20,duration:500,easing:"swing"},v);return this.each(function(){var z=$(this),A=(typeof w.scrollTarget==="number")?w.scrollTarget:$(w.scrollTarget),B=(typeof A==="number")?A:(A.offset().top-z.offset().top)+z.scrollTop()-parseInt(w.offsetTop,10);z.animate({scrollTop:B},parseInt(w.duration,10),w.easing,function(){if(typeof y==="function"){y.call(this)}})})}};return{initialize:c}})}).call(this);